# 效果配置示例

本文档展示如何使用原子效果组合来配置各种技能效果。

## 基础示例

### Effect 46: 先手威力提升

**描述**：先手时威力提升50%

**原子组合**：
- ConditionalCheck(先手) + PowerModifier(+50%)

```json
{
  "effectId": 46,
  "name": "先手威力提升",
  "timing": ["BEFORE_DAMAGE_CALC"],
  "atomicComposition": {
    "type": "composite",
    "atoms": [
      {
        "type": "conditional",
        "condition": "first_strike",
        "then": [
          {
            "type": "power_modifier",
            "mode": "multiply",
            "value": 50
          }
        ]
      }
    ]
  }
}
```

### Effect 43: 后手威力提升

**描述**：后手时威力提升50%

**原子组合**：
- ConditionalCheck(后手) + PowerModifier(+50%)

```json
{
  "effectId": 43,
  "name": "后手威力提升",
  "timing": ["BEFORE_DAMAGE_CALC"],
  "atomicComposition": {
    "type": "composite",
    "atoms": [
      {
        "type": "conditional",
        "condition": "second_strike",
        "then": [
          {
            "type": "power_modifier",
            "mode": "multiply",
            "value": 50
          }
        ]
      }
    ]
  }
}
```

### Effect 39: 伤害增加

**描述**：自身造成的伤害增加50%

**原子组合**：
- DamageModifier(+50%)

```json
{
  "effectId": 39,
  "name": "伤害增加",
  "timing": ["BEFORE_DAMAGE_CALC"],
  "atomicComposition": {
    "type": "composite",
    "atoms": [
      {
        "type": "damage_modifier",
        "mode": "multiply",
        "value": 50
      }
    ]
  }
}
```

## 条件效果示例

### Effect 44: 对方异常状态威力提升

**描述**：对方处于异常状态时，威力提升50%

**原子组合**：
- ConditionalCheck(对方有状态) + PowerModifier(+50%)

```json
{
  "effectId": 44,
  "name": "对方异常状态威力提升",
  "timing": ["BEFORE_DAMAGE_CALC"],
  "atomicComposition": {
    "type": "composite",
    "atoms": [
      {
        "type": "conditional",
        "condition": "target_has_status",
        "then": [
          {
            "type": "power_modifier",
            "mode": "multiply",
            "value": 50
          }
        ]
      }
    ]
  }
}
```

### Effect 48: 自身异常状态威力提升

**描述**：自身处于异常状态时，威力提升50%

**原子组合**：
- ConditionalCheck(自身有状态) + PowerModifier(+50%)

```json
{
  "effectId": 48,
  "name": "自身异常状态威力提升",
  "timing": ["BEFORE_DAMAGE_CALC"],
  "atomicComposition": {
    "type": "composite",
    "atoms": [
      {
        "type": "conditional",
        "condition": "self_has_status",
        "then": [
          {
            "type": "power_modifier",
            "mode": "multiply",
            "value": 50
          }
        ]
      }
    ]
  }
}
```

### Effect 50: 低血威力提升

**描述**：自身HP小于1/2时，威力增加2倍

**原子组合**：
- ConditionalCheck(HP<50%) + PowerModifier(×2)

```json
{
  "effectId": 50,
  "name": "低血威力提升",
  "timing": ["BEFORE_DAMAGE_CALC"],
  "atomicComposition": {
    "type": "composite",
    "atoms": [
      {
        "type": "conditional",
        "condition": "hp_percent_below",
        "value": 50,
        "then": [
          {
            "type": "power_modifier",
            "mode": "multiply",
            "value": 100
          }
        ]
      }
    ]
  }
}
```

## 复杂效果示例

### Effect 40: 偶数伤害提升

**描述**：偶数伤害提升到3倍

**原子组合**：
- ConditionalCheck(偶数伤害) + DamageModifier(×3)

```json
{
  "effectId": 40,
  "name": "偶数伤害提升",
  "timing": ["AFTER_DAMAGE_CALC"],
  "atomicComposition": {
    "type": "composite",
    "atoms": [
      {
        "type": "conditional",
        "condition": "damage_even",
        "then": [
          {
            "type": "damage_modifier",
            "mode": "multiply",
            "value": 200
          }
        ]
      }
    ]
  }
}
```

### Effect 41: 奇数伤害减少

**描述**：奇数伤害改为1/3

**原子组合**：
- ConditionalCheck(奇数伤害) + DamageModifier(÷3)

```json
{
  "effectId": 41,
  "name": "奇数伤害减少",
  "timing": ["AFTER_DAMAGE_CALC"],
  "atomicComposition": {
    "type": "composite",
    "atoms": [
      {
        "type": "conditional",
        "condition": "damage_odd",
        "then": [
          {
            "type": "damage_modifier",
            "mode": "multiply",
            "value": -66.67
          }
        ]
      }
    ]
  }
}
```

## 多条件效果示例

### Effect 52: 对方能力提升时威力增加

**描述**：对方有能力提升时，威力增加2倍

**原子组合**：
- ConditionalCheck(对方能力提升) + PowerModifier(×2)

```json
{
  "effectId": 52,
  "name": "对方能力提升时威力增加",
  "timing": ["BEFORE_DAMAGE_CALC"],
  "atomicComposition": {
    "type": "composite",
    "atoms": [
      {
        "type": "conditional",
        "condition": "target_stat_boosted",
        "then": [
          {
            "type": "power_modifier",
            "mode": "multiply",
            "value": 100
          }
        ]
      }
    ]
  }
}
```

### Effect 54: 对方能力下降时威力增加

**描述**：对方有能力下降时，威力增加2倍

**原子组合**：
- ConditionalCheck(对方能力下降) + PowerModifier(×2)

```json
{
  "effectId": 54,
  "name": "对方能力下降时威力增加",
  "timing": ["BEFORE_DAMAGE_CALC"],
  "atomicComposition": {
    "type": "composite",
    "atoms": [
      {
        "type": "conditional",
        "condition": "target_stat_lowered",
        "then": [
          {
            "type": "power_modifier",
            "mode": "multiply",
            "value": 100
          }
        ]
      }
    ]
  }
}
```

## 持续效果示例（待实现）

### Effect 53: N回合伤害倍增

**描述**：3回合内，令自身的攻击伤害增加2倍

**原子组合**：
- DurationWrapper(3回合, DamageModifier(×2))

```json
{
  "effectId": 53,
  "name": "N回合伤害倍增",
  "timing": ["AFTER_SKILL"],
  "atomicComposition": {
    "type": "composite",
    "atoms": [
      {
        "type": "duration",
        "duration": 3,
        "effect": {
          "type": "damage_modifier",
          "mode": "multiply",
          "value": 100
        }
      }
    ]
  }
}
```

### Effect 42: N回合电系伤害提升

**描述**：1~3回合内，自身的电招式伤害提升100%

**原子组合**：
- ConditionalCheck(回合范围1-3) + ConditionalCheck(电系技能) + DamageModifier(+100%)

```json
{
  "effectId": 42,
  "name": "N回合电系伤害提升",
  "timing": ["AFTER_SKILL"],
  "atomicComposition": {
    "type": "composite",
    "atoms": [
      {
        "type": "conditional",
        "condition": "turn_range",
        "value": "1-3",
        "then": [
          {
            "type": "conditional",
            "condition": "skill_type_match",
            "value": 13,
            "then": [
              {
                "type": "damage_modifier",
                "mode": "multiply",
                "value": 100
              }
            ]
          }
        ]
      }
    ]
  }
}
```

## 概率效果示例（待实现）

### Effect 32: 致死攻击概率留血

**描述**：受到致死攻击时有3%几率余下1点体力

**原子组合**：
- ConditionalCheck(概率3%) + ConditionalCheck(致死伤害) + FixedDamage(留1血)

```json
{
  "effectId": 32,
  "name": "致死攻击概率留血",
  "timing": ["AFTER_DAMAGE_CALC"],
  "atomicComposition": {
    "type": "composite",
    "atoms": [
      {
        "type": "conditional",
        "condition": "probability",
        "value": 3,
        "then": [
          {
            "type": "conditional",
            "condition": "damage_above",
            "value": "self_hp",
            "then": [
              {
                "type": "damage_modifier",
                "mode": "set",
                "value": "self_hp - 1"
              }
            ]
          }
        ]
      }
    ]
  }
}
```

## 配置规范

### 1. 基本结构

```json
{
  "effectId": number,
  "name": string,
  "timing": string[],
  "atomicComposition": {
    "type": "composite",
    "atoms": IAtomicEffectParams[]
  }
}
```

### 2. 原子效果参数

每个原子效果都有 `type` 字段，其他字段根据类型而定：

```typescript
// 条件判断
{
  "type": "conditional",
  "condition": ConditionType,
  "value"?: number | string,
  "then"?: IAtomicEffectParams[],
  "else"?: IAtomicEffectParams[]
}

// 伤害修正
{
  "type": "damage_modifier",
  "mode": "multiply" | "add" | "set",
  "value": number
}

// 威力修正
{
  "type": "power_modifier",
  "mode": "multiply" | "add" | "set",
  "value": number
}
```

### 3. 修正模式说明

- `multiply`: 乘法修正，value为百分比（50表示+50%，即×1.5）
- `add`: 加法修正，value为固定值
- `set`: 设置为固定值

### 4. 条件嵌套

条件可以嵌套，实现复杂的逻辑：

```json
{
  "type": "conditional",
  "condition": "first_strike",
  "then": [
    {
      "type": "conditional",
      "condition": "hp_percent_below",
      "value": 50,
      "then": [
        {
          "type": "power_modifier",
          "mode": "multiply",
          "value": 100
        }
      ]
    }
  ]
}
```

这表示：如果先手 AND HP<50%，则威力×2
